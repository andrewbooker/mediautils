<html>
    <head>
        <style>
        body {
            background-color: black;
            color: white;
        }
        input {
            width: 60px;
        }
        </style>
    </head>
    <body>
        <div>
            <textarea id="fileList" rows="4" cols="100"></textarea>
        </div>
        <div>
            <button id="load">Load</button>
            <button id="play">Play</button>
            <label>Start at</label>
            <input id="startAt" type="text"></input>
        </div>
        <div id="videos"></div>
        <script>
document.getElementById("fileList").focus();
document.getElementById("load").setAttribute("onclick", "load();");

const globalStart = () => {
    return new Number(document.getElementById("startAt").value);
};



const loadOne = (f, i) => {
    const container = document.createElement("div");
    const v = document.createElement("video");
    const vs = document.createElement("source");
    vs.setAttribute("src", f);
    vs.setAttribute("type", "video/mp4");
    v.setAttribute("height", 360);
    v.setAttribute("width", 640);
    const id = "video" + i;
    videoCtls.push(v);
    v.setAttribute("id", id);
    v.load();

    v.appendChild(vs);
    container.appendChild(v);

    const setOffset = document.createElement("input");
    setOffset.setAttribute("id", "videoStartAt" + i);
    setOffset.onchange = function() {
        v.currentTime = globalStart() + new Number(setOffset.value);
    };
    const oc = document.createElement("div");
    oc.appendChild(setOffset);
    container.appendChild(oc);

    const ct = document.createElement("div");
    setInterval(() => {
        ct.innerHTML = v.currentTime;
    }, 100)
    container.appendChild(ct);

    document.getElementById("videos").appendChild(container);
};


const videoCtls = [];


const syncStarts = () => {
    videoCtls.forEach((v, i) => {
        v.currentTime = globalStart() + new Number(document.getElementById("videoStartAt" + i).value);
    });
};


document.getElementById("startAt").onchange = syncStarts;


const load = () => {
    const fileListInput = document.getElementById("fileList");
    const fileList = fileListInput.value
    const files = JSON.parse(fileList);
    Object.keys(files).forEach((f, i) => {
        loadOne(f, i);
    });
};

const button = document.getElementById("play");
const play = () => {
    videoCtls.forEach(v => v.play());
    button.innerHTML = "Pause"
    button.setAttribute("onclick", "pause();");
};
const pause = () => {
    videoCtls.forEach(v => v.pause());
    button.innerHTML = "Play"
    button.setAttribute("onclick", "play();");
};
button.setAttribute("onclick", "play();");


        </script>
    </body>
</html>
